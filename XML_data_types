# Create your own XML script (root must containt your name, e.g. <bookstore_NameSurname>) and convert it into table.

DECLARE @xmlhandle INT -- descriptor declare
DECLARE @xmlinput XML -- input XML document declare

-- creating XML doc with my readlist 2021 and loading it to a variable @xmlinput
SET @xmlinput='<booklist2021_Maryna_Molchan>  
    <storage>
        <book_name>Relational databases</book_name>
		<author_name>Svyatoslav Kulikov</author_name>
        <read_month>June</read_month>
    </storage>
	<storage>
        <book_name>Alan Turing: The Enigma</book_name>
		<author_name>Andrew Hodges</author_name>
        <read_month>May</read_month>
    </storage>
	<storage>
        <book_name>A Mind For Numbers</book_name>
		<author_name> Barbara Ann Oakley</author_name>
        <read_month>April</read_month>
    </storage>
	<storage>
        <book_name>What and when to eat</book_name>
		<author_name>Andrey Beloveshkin</author_name>
        <read_month>March</read_month>
    </storage>
	<storage>
        <book_name>Just Masa</book_name>
		<author_name>Boris Akunin</author_name>
        <read_month>February</read_month>
    </storage>
	<storage>
        <book_name>Naked statistics</book_name>
		<author_name>Charles Willan</author_name>
        <read_month>January</read_month>
    </storage>
</booklist2021_Maryna_Molchan>'

-- create handle of internal xml document representation
EXEC sp_xml_preparedocument @xmlhandle OUTPUT, @xmlinput

-- create table with columns named according to the data in the xml document
CREATE TABLE Books_2021_Table(
	book_name varchar(50), 
	author_name varchar(50), 
	read_month varchar (50)
);

-- define parsing criteria
INSERT INTO Books_2021_Table SELECT * FROM OPENXML(@xmlhandle, '/booklist2021_Maryna_Molchan/storage', 2) 
WITH (
	book_name varchar(50), 
	author_name varchar(50), 
	read_month varchar (50)
)

-- release xml resources
EXEC sp_xml_removedocument @xmlhandle

-- check the data import from the xml document into the table
SELECT * FROM Books_2021_Table
